---
title: "[λ°μ΄μ½ μ‹¬λ¦¬μ„±ν–¥ μμΈ΅ λ€ν] λ¬Έμμ—΄μ΄ ν¬ν•¨λ λ°μ΄ν„° μ²λ¦¬ν•κΈ°"
date: 2020-10-05
categories: λ°μ΄μ½λ¦¬λ·°
toc: true
toc_sticky: true
toc_label: "λ©μ°¨"
tags : data dacon contest
header:
  teaser: "https://github.com/Jihyun22/Jihyun22.github.io/blob/master/_posts/images/teasers/psychology.png?raw=true"
---

<p>
  <img src="https://visitor-badge.laobi.icu/badge?page_id=jihyun22.github.io/λ°μ΄μ½λ¦¬λ·°/psychology-01/" alt="visitor"/>
</p>



<img src= "https://github.com/Jihyun22/Jihyun22.github.io/blob/master/_posts/images/teasers/psychology.png?raw=true">

μ›”κ°„λ°μ΄μ½ 8 μ‹¬λ¦¬ μ„±ν–¥ μμΈ΅ κ²½μ§„ λ€ν λ¦¬λ·°μ…λ‹λ‹¤. 

- λ°μ΄μ½ λ€ν μ•λ‚΄ λ°”λ΅κ°€κΈ° [λ§ν¬](https://dacon.io/competitions/official/235647/overview/)



---

# π€ κ°μ” 


μ΄λ² μ›”κ°„ λ°μ΄μ½μ μ‹¬λ¦¬ μ„±ν–¥ μμΈ΅ κ²½μ§„λ€νλ” λ§ν‚¤μ•„λ°Έλ¦¬μ¦ μ‹¬λ¦¬ ν…μ¤νΈλ¥Ό ν™μ©ν•μ—¬ ν…μ¤νΈ μ°Έκ°€μμ κµ­κ°€ μ„ κ±° ν¬ν‘ μ—¬λ¶€λ¥Ό μμΈ΅ν•λ” λ€νμ…λ‹λ‹¤.

μ£Όμ–΄μ§„ λ°μ΄ν„°λ” train λ°μ΄ν„° κΈ°μ¤€ 78κ°μ μΉΌλΌμ΄ μμΌλ©° 'education' λ“± λ¬Έμμ—΄μ΄ ν¬ν•¨λ λ³€μλ„ μμµλ‹λ‹¤.

- λ°μ΄ν„° μ„¤λ… λ°”λ΅κ°€κΈ° [λ§ν¬](https://dacon.io/competitions/official/235647/talkboard/401534?page=1&dtype=recent&ptype=pub)

μ΄λ² ν¬μ¤νΈμ—μ„λ” `get_dummies()` λ¥Ό μ‚¬μ©ν• λ¬Έμμ—΄μ΄ ν¬ν•¨λ λ³€μλ¥Ό μ²λ¦¬ν•λ” λ°©λ²•μ— λ€ν•΄ λ‹¤λ£¨κ² μµλ‹λ‹¤. Label encoding κ³Ό κ΄€λ ¨λ λ¬Έμ μ…λ‹λ‹¤.

λ°μ΄ν„° λ‹¤μ΄μ€ μ•„λ λ§ν¬λ¥Ό μ°Έκ³ ν•μ„Έμ”.

- λ°μ΄ν„° λ‹¤μ΄λ΅λ“ [λ§ν¬](http://bit.ly/%EC%8B%AC%EB%A6%AC%EB%8D%B0%EC%9D%B4%ED%84%B0) (λ€ν μ°Έκ°€ μ‹ μ²­ ν›„ κ°€λ¥)

---



# 1βƒ£ λ°μ΄ν„° λ΅λ“


μ‚¬μ© μ–Έμ–΄λ” `python` , κµ¬ν„ ν™κ²½μ€  `jupyter notebook` μ…λ‹λ‹¤.

```python
import pandas as pd
import numpy as np
```

λ°μ΄ν„° μ΅°μ‘μ„ μ„ν•΄ `pandas`μ™€ `numpy`λ¥Ό μ„ν¬νΈν–μµλ‹λ‹¤.



```python
train=pd.read_csv('data/train.csv', index_col=0)
test=pd.read_csv('data/test_x.csv', index_col=0)
submission=pd.read_csv('data/sample_submission.csv', index_col=0)  
```

μ£Όμ–΄μ§„ λ°μ΄ν„°λ” `csv` ν•μ‹μ…λ‹λ‹¤. λ°μ΄ν„°λ¥Ό λ¶λ¬μ¤κΈ° μ„ν•΄ pathλ¥Ό μ„¤μ •ν•κ³  `pandas`μ `read_csv()`λ©”μ†λ“λ¥Ό μ‚¬μ©ν–μµλ‹λ‹¤. 



```python
train
```

|   QaA |  QaE |  QbA |  QbE |  QcA |  QcE |  QdA |  QdE |  QeA |  QeE |  ... | wr_04 | wr_05 | wr_06 | wr_07 | wr_08 | wr_09 | wr_10 | wr_11 | wr_12 | wr_13 |      |
| ----: | ---: | ---: | ---: | ---: | ---: | ---: | ---: | ---: | ---: | ---: | ----: | ----: | ----: | ----: | ----: | ----: | ----: | ----: | ----: | ----: | ---: |
| index |      |      |      |      |      |      |      |      |      |      |       |       |       |       |       |       |       |       |       |       |      |
|     0 |  3.0 |  363 |  4.0 | 1370 |  5.0 |  997 |  1.0 | 1024 |  2.0 | 1577 |   ... |     0 |     1 |     0 |     1 |     1 |     0 |     1 |     0 |     1 |    1 |
|     1 |  5.0 |  647 |  5.0 | 1313 |  3.0 | 3387 |  5.0 | 2969 |  1.0 | 4320 |   ... |     1 |     1 |     0 |     1 |     1 |     0 |     1 |     0 |     1 |    1 |
|     2 |  4.0 | 1623 |  1.0 | 1480 |  1.0 | 1021 |  4.0 | 3374 |  5.0 | 1333 |   ... |     1 |     1 |     0 |     1 |     1 |     1 |     1 |     0 |     1 |    1 |
|     3 |  3.0 |  504 |  3.0 | 2311 |  4.0 |  992 |  3.0 | 3245 |  1.0 |  357 |   ... |     0 |     0 |     0 |     0 |     1 |     0 |     1 |     0 |     1 |    1 |
|     4 |  1.0 |  927 |  1.0 |  707 |  5.0 |  556 |  2.0 | 1062 |  1.0 | 1014 |   ... |     1 |     1 |     1 |     1 |     1 |     0 |     1 |     1 |     1 |    1 |
|   ... |  ... |  ... |  ... |  ... |  ... |  ... |  ... |  ... |  ... |  ... |   ... |   ... |   ... |   ... |   ... |   ... |   ... |   ... |   ... |   ... |  ... |
| 45527 |  2.0 | 1050 |  5.0 |  619 |  4.0 |  328 |  1.0 |  285 |  1.0 |  602 |   ... |     1 |     1 |     0 |     1 |     1 |     1 |     1 |     0 |     1 |    1 |
| 45528 |  2.0 |  581 |  3.0 | 1353 |  4.0 | 1164 |  1.0 |  798 |  3.0 | 1680 |   ... |     1 |     1 |     0 |     1 |     1 |     1 |     1 |     0 |     1 |    1 |
| 45529 |  4.0 |  593 |  1.0 |  857 |  1.0 | 1047 |  4.0 | 1515 |  5.0 | 1690 |   ... |     1 |     1 |     0 |     1 |     1 |     0 |     1 |     0 |     1 |    1 |
| 45530 |  1.0 |  747 |  3.0 | 1331 |  4.0 |  892 |  2.0 | 1281 |  1.0 | 1328 |   ... |     1 |     1 |     0 |     1 |     1 |     1 |     1 |     0 |     1 |    1 |
| 45531 |  3.0 |  496 |  5.0 | 1827 |  5.0 |  754 |  3.0 | 1117 |  1.0 |  432 |   ... |     1 |     1 |     0 |     1 |     1 |     0 |     1 |     0 |     1 |    1 |

>  45532 rows Γ— 77 columns

λ°μ΄ν„°κ°€ μ •μƒμ μΌλ΅ λ΅λ“λμ—μµλ‹λ‹¤.

train λ°μ΄ν„°λ” 77κ°μ μΉΌλΌμΌλ΅ κµ¬μ„±λμ–΄ μμµλ‹λ‹¤. λΌλ²¨μ΄ ν¬ν•¨λ κ°’μΌλ΅ μ£Όμ–΄μ§„ λ°μ΄ν„° μ„¤λ…μ— λ§κ² `vote` μΉΌλΌμ„ λΌλ²¨ yλ΅ μ‚¬μ©ν•κ² μµλ‹λ‹¤.



```python
X = train.drop('voted', axis = 1)
y = train['voted']
```

`axis = 1` λ” μΉΌλΌμ„ drop ν•  λ• μ—΄μ„ κΈ°μ¤€μΌλ΅ dropν•λ‹¤λ” μµμ…μ…λ‹λ‹¤. Xλ” λΌλ²¨μ΄ μ μ™Έλ λ°μ΄ν„°κ°€, yλ” λΌλ²¨κ°’μ΄ ν¬ν•¨λ©λ‹λ‹¤. 

---



# 2βƒ£ λ°μ΄ν„° μ „μ²λ¦¬ - μΈμ½”λ”©


μΉΌλΌ λ³„λ΅ λ°μ΄ν„°μ— ν¬ν•¨λ κ°’μ„ ν™•μΈν•΄λ³΄κ² μµλ‹λ‹¤. λ¬Έμ μ—μ„ μ£Όμ–΄μ§„ λ°μ΄ν„° μ„¤λ… μ¤‘ μΌλ¶€ μΉΌλΌμ— λ²”μ£Όν• λ°μ΄ν„° κ°’μ΄ ν¬ν•¨λ κ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤. 



μ—΄μ λ‚΄μ©μ„ ν™•μΈν•κΈ° μ„ν•΄ `pandas`μ `value_count()` λ©”μ†λ“λ¥Ό μ‚¬μ©ν•κ² μµλ‹λ‹¤.

```python
print(X.race.value_counts())
```

>White							31248
>Asian							 6834
>Other							4330
>Black							 2168
>Native American		 548
>Arab									  351
>Indigenous Australian		53
>Name: race, dtype: int64

`race`κ°’μ€ 7κ°μ κ°’μ„ κ°€μ§€κ³  μμµλ‹λ‹¤. μ΄ μ™Έμ—λ„ `religion`, `age_group`, `gender` λ³€μκ°€ strν•νƒμ κ°’μ„ ν¬ν•¨ν•©λ‹λ‹¤.



`pandas`μ `get_dummies()` λ©”μ†λ“λ΅ μ‰½κ² μ›ν•« μΈμ½”λ”©μ„ μν–‰ν•  μ μμµλ‹λ‹¤. μΉΌλΌ λ¦¬μ¤νΈλ¥Ό λΉ„κµν•μ—¬ μΈμ½”λ”© ν¨κ³Όλ¥Ό μ‚΄ν΄λ³΄κ² μµλ‹λ‹¤.

```python
print("columns list : ", list(X.columns), "\n")
X_dummies = pd.get_dummies(X)
print("get_dummies columns list : ", list(X_dummies.columns))
```

>columns list :  ['QaA', 'QaE', 'QbA', 'QbE', 'QcA', 'QcE', 'QdA', 'QdE', 'QeA', 'QeE', 'QfA', 'QfE', 'QgA', 'QgE', 'QhA', 'QhE', 'QiA', 'QiE', 'QjA', 'QjE', 'QkA', 'QkE', 'QlA', 'QlE', 'QmA', 'QmE', 'QnA', 'QnE', 'QoA', 'QoE', 'QpA', 'QpE', 'QqA', 'QqE', 'QrA', 'QrE', 'QsA', 'QsE', 'QtA', 'QtE', 'age_group', 'education', 'engnat', 'familysize', 'gender', 'hand', 'married', 'race', 'religion', 'tp01', 'tp02', 'tp03', 'tp04', 'tp05', 'tp06', 'tp07', 'tp08', 'tp09', 'tp10', 'urban', 'wf_01', 'wf_02', 'wf_03', 'wr_01', 'wr_02', 'wr_03', 'wr_04', 'wr_05', 'wr_06', 'wr_07', 'wr_08', 'wr_09', 'wr_10', 'wr_11', 'wr_12', 'wr_13'] 
>
>get_dummies columns list :  ['QaA', 'QaE', 'QbA', 'QbE', 'QcA', 'QcE', 'QdA', 'QdE', 'QeA', 'QeE', 'QfA', 'QfE', 'QgA', 'QgE', 'QhA', 'QhE', 'QiA', 'QiE', 'QjA', 'QjE', 'QkA', 'QkE', 'QlA', 'QlE', 'QmA', 'QmE', 'QnA', 'QnE', 'QoA', 'QoE', 'QpA', 'QpE', 'QqA', 'QqE', 'QrA', 'QrE', 'QsA', 'QsE', 'QtA', 'QtE', 'education', 'engnat', 'familysize', 'hand', 'married', 'tp01', 'tp02', 'tp03', 'tp04', 'tp05', 'tp06', 'tp07', 'tp08', 'tp09', 'tp10', 'urban', 'wf_01', 'wf_02', 'wf_03', 'wr_01', 'wr_02', 'wr_03', 'wr_04', 'wr_05', 'wr_06', 'wr_07', 'wr_08', 'wr_09', 'wr_10', 'wr_11', 'wr_12', 'wr_13', 'age_group_+70s', 'age_group_10s', 'age_group_20s', 'age_group_30s', 'age_group_40s', 'age_group_50s', 'age_group_60s', 'gender_Female', 'gender_Male', 'race_Arab', 'race_Asian', 'race_Black', 'race_Indigenous Australian', 'race_Native American', 'race_Other', 'race_White', 'religion_Agnostic', 'religion_Atheist', 'religion_Buddhist', 'religion_Christian_Catholic', 'religion_Christian_Mormon', 'religion_Christian_Other', 'religion_Christian_Protestant', 'religion_Hindu', 'religion_Jewish', 'religion_Muslim', 'religion_Other', 'religion_Sikh']

`get_dummies()` λ¥Ό ν†µν•΄ μλ™μΌλ΅ μΈμ½”λ”© λ ν›„ μΉΌλΌ μ΄λ¦„μ΄ λ°°μ •λ κ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤.



λ‹¤μμ€ μΈμ½”λ”© μ „ν›„μ μΉΌλΌ μλ¥Ό λΉ„κµν•κ² μµλ‹λ‹¤.

```python
print("X: {}\nX_dummies: {}".format(X.shape, X_dummies.shape))
```

> X: (45532, 76)
> X_du: (45532, 100)

76κ°μ μΉΌλΌμ—μ„ 100κ°μ μΉΌλΌμΌλ΅ λμ–΄λ‚¬μµλ‹λ‹¤.



λ™μΌν• μ‘μ—…μ„ test λ°μ΄ν„° μ…‹μ—λ„ μ μ©ν•κ² μµλ‹λ‹¤. μ΄λ• μΈμ½”λ”© ν›„ train λ°μ΄ν„°μ™€ μΉΌλΌ listκ°€ μΌμΉν•λ”μ§€ ν™•μΈν•΄μ•Ό ν•©λ‹λ‹¤. λ°μ΄ν„°μ…‹μ— ν¬ν•¨λ κ°’μ— μ°¨μ΄κ°€ μλ‹¤λ©΄, μΉΌλΌ λ¦¬μ¤νΈκ°€ λ‹¬λΌμ§ μ μκΈ° λ•λ¬Έμ…λ‹λ‹¤.

```python
test = pd.get_dummies(test)
test.shape
```

> (11383, 100)

```python
print("True") if list(X_dummies.columns) == list(test.columns) else list(test.columns)
```

> True

μΉΌλΌ κ°―μκ°€ train λ°μ΄ν„°μ™€ λ™μΌν•κ² 100κ°λ΅ λμ–΄λ‚¬μµλ‹λ‹¤. μΉΌλΌ λ¦¬μ¤νΈλ” train λ°μ΄ν„°μ™€ λ™μΌν•©λ‹λ‹¤.



μΈμ½”λ”©μ΄ μ™„λ£λμ—μµλ‹λ‹¤.  μ¶”κ°€μ μΌλ΅ λ§ν‚¤μ•„λ²¨λ¦¬μ¦ ν…μ¤νΈ scoreμ„ κ³„μ‚°ν•μ—¬ μΉΌλΌμ„ μƒμ„±ν•λ” λ°©μ‹μΌλ΅ EDAλ¥Ό μ§„ν–‰ν•λ‹¤λ©΄ λ”μ± μλ―Έμλ” μ‘μ—…μ΄ λκ² μ§€λ§ μ΄λ² κ²μ‹λ¬Όμ—μ„λ” λ‹¨μ μΈμ½”λ”©μΌλ΅ μ „μ²λ¦¬λ¥Ό λ§λ¬΄λ¦¬ν•κ² μµλ‹λ‹¤.



μ΄μ–΄μ§€λ” κ²μ‹λ¬Όμ—μ„λ” AutoML λ¶„μ•ΌμΈ ν•μ΄νΌ νλΌλ―Έν„° νλ‹μ„ λ‹¤λ£¨κ² μµλ‹λ‹¤. μ•„λ λ§ν¬μ—μ„ ν•΄λ‹Ή λ‚΄μ©μ λ…ΈνΈλ¶μ„ ν™•μΈν•  μ μμµλ‹λ‹¤.

- data_encoding.ipynb [λ§ν¬](https://github.com/Jihyun22/Dacon_workspace/blob/master/psychology/data_encoding.ipynb)

κ°μ‚¬ν•©λ‹λ‹¤.

