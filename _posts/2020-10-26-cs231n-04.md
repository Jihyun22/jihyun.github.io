---
title: "[CS231n] Lecture 4 - Backpropagation and Neural Networks"
date: 2020-10-26
categories: dl
toc: true
toc_sticky: true
toc_label: "ëª©ì°¨"
tags : data dl datastudy cs231n
related: true
header:
  teaser: "https://github.com/Jihyun22/Jihyun22.github.io/blob/master/_posts/images/teasers/cs231n.png?raw=true"
---



<img src= "https://github.com/Jihyun22/Jihyun22.github.io/blob/master/_posts/images/teasers/cs231n.png?raw=true">

ìŠ¤íƒ í¬ë“œ ëŒ€í•™ì˜ CS231n ê°•ì˜ë…¸íŠ¸ì…ë‹ˆë‹¤. 

CS231nê°•ì˜ëŠ” 1~16ê°•ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆìœ¼ë©° ì´ë²ˆ í¬ìŠ¤íŠ¸ëŠ” **Lecture 4 - Backpropagation and Neural Networks** ì— ëŒ€í•´ ë‹¤ë£¨ê² ìŠµë‹ˆë‹¤.

*ê°€ì§œì—°êµ¬ì†Œ*ì˜ *ë”¥ëŸ¬ë‹ ì´ë¡  ìŠ¤í„°ë””* í™œë™ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

- youtube ê°•ì˜ ì˜ìƒ ë°”ë¡œê°€ê¸° [ë§í¬](https://youtu.be/vT1JzLTH4G4?list=PLC1qU-LWwrF64f4QKQT-Vg5Wr4qEE1Zxk)
- ê°€ì§œì—°êµ¬ì†Œ ì‚¬ì´íŠ¸ ë°”ë¡œê°€ê¸° [ë§í¬](https://pseudo-lab.com/)

<center><p>
  <img src="https://visitor-badge.laobi.icu/badge?page_id=jihyun22.github.io/dl/cs231n-02/" alt="visitor"/>
    </p></center>




---

<br/>



# ğŸš€ **ê°œìš”** 

---

<br/>

4ê°•ì—ì„œëŠ” gradient ì˜ ì—°ì‚°ì— ëŒ€í•´ ì†Œê°œí•˜ê³  rnnì— ëŒ€í•´ ì„¤ëª…í•©ë‹ˆë‹¤.

Neural Networksë¥¼ ë‹¤ë£¨ë©° layer ê°œë…ì´ ë“±ì¥í•©ë‹ˆë‹¤.

<br/>

---

## Review

<br/>

![](https://github.com/Jihyun22/Jihyun22.github.io/blob/master/_posts/images/cs231n-4/005.png?raw=true)

<br/>

3ê°•ê¹Œì§€ ë°°ìš´ ë‚´ìš©ì€ **ê°€ì¤‘ì¹˜ê°€ ë³€í•˜ë©´ì„œ Loss ê°’ì— ì–´ë–¤ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ”ê°€** ì…ë‹ˆë‹¤.

ìµœì¢… ë¡œìŠ¤ë¥¼ ìµœì†Œí™”í•˜ê¸° ìœ„í•´ wì˜ ìµœì ê°’ì„ êµ¬í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ë°°ì› ìŠµë‹ˆë‹¤.

<br/>

![](https://github.com/Jihyun22/Jihyun22.github.io/blob/master/_posts/images/cs231n-4/007.png?raw=true)

<br/>

ì´ë•Œ ë“±ì¥í•œ ê°œë…ì´ `gradient` ì…ë‹ˆë‹¤. 

`gradient`ë¥¼ ê³„ì‚°í•  ë•Œì—ëŠ” ì¼ì¼íˆ ê³„ì‚°í•˜ëŠ” Numerical gradient ìœ¼ë¡œ ì´ˆê¸° ê³„ì‚°ì„ ì§„í–‰í•˜ê³ , ì‹¤ì œ ê°’ì„ ì—°ì‚°í•˜ê¸° ìœ„í•´ì„œëŠ” Analytic gradient ë°©ë²•ì„ ì‚¬ìš©í•˜ì—¬ ìµœì¢… checkë¥¼ ì§„í–‰í•©ë‹ˆë‹¤.

<br/>

![](https://github.com/Jihyun22/Jihyun22.github.io/blob/master/_posts/images/cs231n-4/008.png?raw=true)

<br/>

ì´ëŸ¬í•œ ì—°ì‚° ê³¼ì •ì„ ë‹¨ìˆœíˆ ì •ë¦¬í•˜ë©´ ìœ„ì˜ ê·¸ë˜í”„ì™€ ê°™ìŠµë‹ˆë‹¤. 

ë²¡í„° xì™€ ê°€ì¤‘ì¹˜ ì—°ì‚°ì„ í†µí•´ scoreì„ ê³„ì‚°í•œ í›„ íŒì§€ ë¡œìŠ¤, ì¦‰ Loss Fuctionì„ í†µí•´ Loss ê°’ì„ ìµœì†Œí™”í•  ìˆ˜ ìˆë„ë¡ ì¡°ì •í•©ë‹ˆë‹¤.

ì´ë•Œ train dataì˜ overfittingì„ ë°©ì§€í•˜ê¸° ìœ„í•´ ì •ê·œí™” í•­ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

ë‹¤ë§Œ, ì¼ë°˜ì ì¸ ê³„ì‚° ê³¼ì •ì´ ìœ„ ì‚¬ì§„ì²˜ëŸ¼ ë‹¨ìˆœí•œ ê·¸ë˜í”„ë¡œ ë‚˜íƒ€ë‚˜ëŠ” ê²ƒì€ ì•„ë‹™ë‹ˆë‹¤.

<br/>

![](https://github.com/Jihyun22/Jihyun22.github.io/blob/master/_posts/images/cs231n-4/011.png?raw=true)

<br/>

ìœ„ ì‚¬ì§„ì²˜ëŸ¼ RNNì„ êµ¬ì„±í•˜ê²Œ ë˜ë©´ classê°€ ìˆ˜ê²¹ ìŒ“ì¸ ëª¨í˜•ì´ ë©ë‹ˆë‹¤. 

<br/>

---

## Back / Front propagation

<br/>

ë‹¤ìŒì€ Fuction ê³„ì‚°ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

`gradient` ê°€ ë²¡í„° ì—°ì‚°ê³¼ ê´€ë ¨í•œ ë¯¸ë¶„ê°’ì´ë¼ê³  í•  ë•Œ, ì´ë¥¼ êµ¬í•˜ëŠ” ë°©ë²•ì„ ì†Œê°œí•˜ê² ìŠµë‹ˆë‹¤.

<br/>

![](https://github.com/Jihyun22/Jihyun22.github.io/blob/master/_posts/images/cs231n-4/012.png?raw=true)

<br/>

ìœ„ ê·¸ë˜í”„ëŠ” f(x, y, z)ë¥¼ ê³„ì‚°í•˜ëŠ” ë°©ë²•ì„ ë…¸ë“œë¡œ ì—°ê²°í•œ í‘œí˜„ì‹ì…ë‹ˆë‹¤.

x, y, zê°’ì´ ì£¼ì–´ì¡Œì„ ë•Œ ì™¼ìª½ì—ì„œ ì˜¤ë¥¸ìª½ ë…¸ë“œë¡œ ê±´ë„ˆê°€ë©°(í™”ì‚´í‘œ ì°¸ê³ ) ì—°ì‚°ì´ ì§„í–‰ë©ë‹ˆë‹¤.

ìµœì¢… fê°’ì´ -12ë¡œ ê³„ì‚°ë˜ì—ˆìŠµë‹ˆë‹¤.

ì´ëŸ¬í•œ ì—°ì‚° ë°©ë²•ì´ front propagation ì…ë‹ˆë‹¤.

<br/>

**ìš°ë¦¬ê°€ ì•Œê³  ì‹¶ì€ ê²ƒì€ f(x, y, z)ì—ì„œ ì‹ì˜ ì¸ìì¸ x, y, zê°€ fì— ì–´ë– í•œ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ”ê°€ ì…ë‹ˆë‹¤.**

**ì´ë¥¼ ìˆ˜ì¹˜ì ìœ¼ë¡œ í‘œí˜„í•œê²Œ ë°”ë¡œ `gradient` ì…ë‹ˆë‹¤. ë²¡í„° xì˜ ë¯¸ë¶„ê°’ì´ ì´ëŸ¬í•œ ì˜ë¯¸ë¥¼ í‘œí˜„í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.**

<br/>

![](https://github.com/Jihyun22/Jihyun22.github.io/blob/master/_posts/images/cs231n-4/023.png?raw=true)

<br/>

ì¸ì ë³„ í•¨ìˆ˜ ê°’ì— ëŒ€í•œ ì˜í–¥, ì¦‰ df/dx, df/dy, df/dzë¥¼ ì•Œì•„ë³´ê¸° ìœ„í•´ **backpropagation ì—°ì‚°ì´ í•„ìš”í•©ë‹ˆë‹¤.**

f(x, y, z) = (x+y)z ë¼ê³  í•  ë•Œ, x+y = që¼ê³  ë‘ê³ , ê°ê° ë¯¸ë¶„ê°’ì„ ê³„ì‚°í–ˆìŠµë‹ˆë‹¤.

ë§¨ ì˜¤ë¥¸ìª½ ë…¸ë“œë¶€í„° ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

1. f : ìê¸° ìì‹ ì˜ ë¯¸ë¶„ê°’ì€ 1 ì…ë‹ˆë‹¤.
2. q : df/dq ëŠ” ì´ë¯¸ ê³„ì‚°ë˜ì–´ ìˆìŠµë‹ˆë‹¤(íŒŒë€ ë„¤ëª¨) -> z =  -4 ì…ë‹ˆë‹¤.
3. z : df/dz ë„ ì´ë¯¸ ê³„ì‚°ë˜ì–´ ìˆìŠµë‹ˆë‹¤-> q = 3  ì…ë‹ˆë‹¤.
4. x : df/dx = df/dq * dq/dx = z = -4ì…ë‹ˆë‹¤.
5. y : df/dy = df/dq * dq/dy = z = -4ì…ë‹ˆë‹¤.

ì´ë•Œ dx, dy ê°’ì€ Chain ruleì— ì˜í•´ ê³„ì‚°ë©ë‹ˆë‹¤.

ì´ ê°œë…ì„ **local gradient, global gradient** ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤.

<br/>

![](https://github.com/Jihyun22/Jihyun22.github.io/blob/master/_posts/images/cs231n-4/029.png?raw=true)

<br/>

dx, dyë¥¼ ê³„ì‚°í•˜ê¸° ìœ„í•´ ì‚¬ìš©ëœ dq/dx, dq/dyëŠ” ê°ê° **local gradient** ì…ë‹ˆë‹¤.

ì´ë¯¸ ê³„ì‚°ëœ df/dq, ì¦‰ global gradient ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ë“¤ì˜ ê³±ìœ¼ë¡œ ê³„ì‚°ë©ë‹ˆë‹¤.

<br/>

![](https://github.com/Jihyun22/Jihyun22.github.io/blob/master/_posts/images/cs231n-4/043.png?raw=true)

<br/>

ë‹¤ë¥¸ ì˜ˆì‹œë¡œ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

w0, x0ì˜ ê³„ì‚°ì€ ê³±ì…‰ìœ¼ë¡œ ì—°ê²°ë˜ì–´ ìˆìŠµë‹ˆë‹¤. 

ì´ë•Œ ë³´ë‹¤ upstream gradientë¥¼ ì‚¬ìš©í•˜ë©´ ë¹ ë¥´ê²Œ ê³„ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- w0 : local gradient * upstream gradient = 0.2(ì´ë¯¸ ê³„ì‚°ë¨) * -1(=x0) = -0.2
- x0 : local gradient * upstream gradient = 0.2(ì´ë¯¸ ê³„ì‚°ë¨) * 2(=w0) = 0.4

<br/>

![](https://github.com/Jihyun22/Jihyun22.github.io/blob/master/_posts/images/cs231n-4/050.png?raw=true)

<br/>

ê³±ì…ˆì´ upstream gradient ì„ ì‚¬ìš©í•˜ì—¬ ë¶„ë°° ì—°ì‚°ì´ ìˆ˜í–‰ë˜ëŠ” ê²ƒì²˜ëŸ¼, ë§ì…ˆì€ local gradient ì´ ë™ì¼í•˜ê²Œ ê° í•­ì— ì£¼ì–´ì§€ë©°, maxì—°ì‚°ì€ ë¼ìš°í„° ì—°ì‚°, ì¦‰ 0ê³¼ local gradient ì´ ê°ê° max ì—°ì‚° ê²°ê³¼ê°’ì— ë”°ë¼ ë¶„ë°°ë©ë‹ˆë‹¤.

ì´ëŸ¬í•œ tipì„ í†µí•´ ë”ìš± ë¹ ë¥¸ gradient ì—°ì‚°ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

<br/>

![](https://github.com/Jihyun22/Jihyun22.github.io/blob/master/_posts/images/cs231n-4/045.png?raw=true)

<br/>

ìœ„ íŒê³¼ ë”ë¶ˆì–´ **sigmoid gate**ë¥¼ ì‚¬ìš©í•œë‹¤ë©´ ê³„ì‚° ê³¼ì •ì„ ë”ìš± ì••ì¶•í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

e^-xì—ì„œ x ë§Œí¼ì˜ ì—°ì‚°ì„ të¡œ ì¹˜í™˜í•˜ì—¬ í•´ë‹¹ ì—°ì‚°ê¹Œì§€ ë¬¶ì–´ fì˜ ê²°ê³¼ê°’ê³¼ 1ì—ì„œ ê·¸ ê²°ê³¼ê°’ì„ ëº€ ê°’ ì‚¬ì´ì˜ ê³±ìœ¼ë¡œ ê³„ì‚°í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

![](https://github.com/Jihyun22/Jihyun22.github.io/blob/master/_posts/images/cs231n-4/052.png?raw=true)

<br/>

---

##  Jacobian matrix

<br/>

local gradientì™€ ë”ë¶ˆì–´ì„œ ì‚´í´ë³´ì•„ì•¼ í•  ê°œë…ì¸ **Jacobian matrix**ì— ëŒ€í•´ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤.

 Jacobian matrixì€ local gradient * global gradient ì—°ì‚°ì„ í•  ë•Œ í•„ìš”í•œ matrixë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.

í–‰ë ¬ ê°„ ê³± ê³„ì‚°ì´ í•„ìš”í•œ Jacobian matrixì˜ í¬ê¸°ë¥¼ input, output dimì˜ í¬ê¸°ì™€ ë¹„êµí•˜ì—¬ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

<br/>

![](https://github.com/Jihyun22/Jihyun22.github.io/blob/master/_posts/images/cs231n-4/056.png?raw=true)

<br/>

input ê³¼ outputì˜ í¬ê¸°ê°€ 4096 í¬ê¸°ë¼ê³  í•  ë•Œ,  Jacobian matrixí¬ê¸°ëŠ” 4096 * 4096ì…ë‹ˆë‹¤.

maxì—°ì‚°ì´ ì§„í–‰ë˜ì–´ 0ê³¼ x ì˜ í¬ê¸° ë¹„êµë¥¼ ìœ„í•´ ì¼ë¶€ 0ìœ¼ë¡œ ì±„ì›Œì§„ ì¹¼ëŸ¼ì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

(ìì„¸í•œ ì„¤ëª… ì¶”ê°€í•˜ê¸°)

ì´ë•Œ, ì´ì „ 3ì¥ì—ì„œ ì‚´í´ë³¸ minibatch ê°œë…ì„ ì ìš©í•˜ê² ìŠµë‹ˆë‹¤.

ì´ ê²½ìš°, ì—´ê³¼ í–‰ì— ê°ê° minibatch í¬ê¸°ê°€ ê³±í•´ì ¸ì•¼ ê°€ëŠ¥í•©ë‹ˆë‹¤.



<br/>

---

## Neural Networks

<br/>

ë‹¤ìŒì€ ë‰´ëŸ° ë„¤íŠ¸ì›Œí¬ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

![](https://github.com/Jihyun22/Jihyun22.github.io/blob/master/_posts/images/cs231n-4/086.png?raw=true)

<br/>

ë‰´ëŸ° ë„¤íŠ¸ì›Œí¬ëŠ” ê¸°ì¡´ ì„ í˜• ë¶„ë¥˜ê¸°ë¥¼ ì¸µì„ ìŒ“ì•„ ì—¬ëŸ¬ê²¹ì˜ ì¸µìœ¼ë¡œ êµ¬ì„±ëœ ë¶„ë¥˜ê¸°ë¥¼ ë§Œë“œëŠ” ë°ì—ì„œ ì‹œì‘í•©ë‹ˆë‹¤.

hëŠ” hidden layerë¡œì„œ ì¹¼ëŸ¼ì„ ì¶”ì¶œí•˜ëŠ” ì—­í• ì„ ë§¡ìŠµë‹ˆë‹¤.

ìœ„ ëª¨í˜•ì€ 3072ì˜ input data x ì— ëŒ€í•´ W1ê°€ ì ìš©ëœ ì—°ì‚°ì„ ì§„í–‰í•˜ì—¬ 100ê°œì˜ ì¹¼ëŸ¼ì„ ì¶”ì¶œí•œ í›„, W2 ì„ ê°€ì¤‘í•˜ì—¬ ì—°ì‚°ì„ í†µí•´ ìµœì¢… 10ê°œì˜ classì— ëŒ€í•œ í™•ë¥ ì´ ê³„ì‚°ë©ë‹ˆë‹¤.

<br/>

![](https://github.com/Jihyun22/Jihyun22.github.io/blob/master/_posts/images/cs231n-4/093.png?raw=true)

<br/>

ë‰´ëŸ°ì˜ ë°©ì‹ê³¼ ë¹„ìŠ·í•˜ê²Œ ì—°ì‚°ì´ ì§„í–‰ë©ë‹ˆë‹¤.

ì´ë•Œ fì— ëŒ€í•´ í™œì„±í•¨ìˆ˜ê°€ ì‚¬ìš©ë˜ëŠ”ë° ì¼ë°˜ì ì¸ í™œì„±í•¨ìˆ˜ëŠ” sigmoid ì…ë‹ˆë‹¤.

sigmoidëŠ” 0ê³¼ 1 ì‚¬ì´ ê°’ì„ ê°–ê¸° ë•Œë¬¸ì— ê° classì˜ scoreë¥¼ í‘œì‹œí•˜ê¸° ì í•©í•©ë‹ˆë‹¤.

<br/>

![](https://github.com/Jihyun22/Jihyun22.github.io/blob/master/_posts/images/cs231n-4/096.png?raw=true)

<br/>

ì´ ì™¸ì—ë„ ë‹¤ì–‘í•œ í™œì„±í•¨ìˆ˜ê°€ ì¡´ì¬í•©ë‹ˆë‹¤.

ìš”ì¦ˆìŒì€ ReLUë¥¼ ê¸°ë³¸ì ì¸ í™œì„±í•¨ìˆ˜ë¡œ ì‚¬ìš©í•˜ëŠ” ì¶”ì„¸ì…ë‹ˆë‹¤.

<br/>

![](https://github.com/Jihyun22/Jihyun22.github.io/blob/master/_posts/images/cs231n-4/099.png?raw=true)

<br/>

 3-layerì˜ ë¶„ë¥˜ê¸° ëª¨í˜•ì„ ìˆ˜ë„ì½”ë“œë¡œ ë‚˜íƒ€ë‚´ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤(layer ê°œìˆ˜ë¥¼ ì…€ ë•Œ input layerì€ ì œì™¸í•©ë‹ˆë‹¤).

<br/>

# **ğŸ“— ì •ë¦¬**

 <br/>

ë‰´ëŸ° ë„¤íŠ¸ì›Œí¬ëŠ” ì‹¤ì œ ë‰´ëŸ°ê³¼ ì—°ì‚° ë°©ë²•ì´ ë¹„ìŠ·í•  ë¿ì´ì§€ ì¸ê°„ì˜ ë‰´ëŸ°ì´ í›¨ì”¬ ë” ë³µì¡í•œ êµ¬ì¡°ë¥¼ ê°€ì§‘ë‹ˆë‹¤.

ë‹¤ìŒì€ CNN ë„¤íŠ¸ì›Œí¬ë¥¼ ì‚´í´ë³´ë©° RNNê³¼ ë¹„êµí•´ë³´ê² ìŠµë‹ˆë‹¤.

 <br/>







